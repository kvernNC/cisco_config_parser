---
hostname: {{ios_hostname.matches.0}}
version: {{ios_major_version.matches.0}}
{%if ios_snmp_community is defined%}
snmp_community:
{%for community in ios_snmp_community%}
  - name: {{community.matches.0}}
    access: {{community.matches.1}}
{%endfor%}
{%endif%}
{%if ios_numbered_acl is defined or ios_named_acl%}
ACL:
{% for number in ios_numbered_acl|map(attribute='matches.0')|unique|list|sort%}
  - name: {{number}}
    rules:
{%for acl in ios_numbered_acl%}
{%if acl.matches.0 == number%}
      - {{acl.matches.1}}
{%endif%}
{%endfor%}
{%endfor%}
{% for acl in ios_named_acl%}
  - name: {{acl.name.matches.0}}
    type: {{acl.type.matches.0}}
    rules:
{%for rule in acl.rules%}
      - {{rule.matches}}
{%endfor%}
{%endfor%}
{%endif%}
{%if ios_line is defined%}
line:
{%for line in ios_line%}
  - id: {{line.id.matches.0}}
    type: {{line.type.matches.0}}
{%if line.config is defined and line.config.0 is defined and line.config.0.matches is defined%}
    config:
{% for configline in line.config%}
      - {{configline.matches}}
{%endfor%}
{%endif%}
{%endfor%}
{%endif%}
